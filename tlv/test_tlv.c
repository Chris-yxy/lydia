#include "tlv.h"
#include "debug.h"

int32_t on_read_data(uint32_t tag, uint16_t len, uint8_t *v)
{
    DBG(":\n");
    DBG_RAW("tag:%X\r\n", tag);
    DBG_RAW("L:%d\r\n", len);
    HEX_DUMP("V:", v, len);
}

void test_tlv(void)
{
    uint8_t *tlv_msg = "\x70\x81\xB3\x93\x81\xB0\x4C\xD5\x24\xA9\x77\x64\x34\x5C\x44\xB9\x6E\x7A\x74\xE8\x5D\x45\x16\x23\x5E\xE5\x15\xAA\xC0\x50\x88\x77\xF4\x12\x4A\x11\xD6\x4B\x0E\xA8\x81\x84\xFF\x7E\xF5\xB3\x0A\x2A\x12\x7B\xE5\xED\x27\x87\x7F\x65\x1F\xEF\xE0\x73\xEB\x46\x79\x5E\x16\x66\x1F\xA3\x31\xB4\xF1\x10\x98\xFC\x78\x03\xEC\xAE\xF7\x45\x1C\x48\x26\xB6\x16\xAE\xAB\x77\x44\x69\x42\x2C\x1E\x3C\x8C\xF9\xB7\x94\x37\x16\x4E\xDE\x26\x9E\x5F\xD7\x9D\x76\xB8\x46\x4F\x6E\xE8\xAF\xD5\x47\x7C\x1E\x01\xCE\x42\xE7\x22\x35\xE3\x0C\xE1\xB9\x32\xE8\xDB\xF5\x30\xD7\x9B\x16\xA3\xC6\x08\xB4\xE0\x80\x12\x0D\x91\x2B\x48\x6B\x52\x5E\x08\x12\xDE\x09\x7F\xC8\xE5\x06\x6E\x94\x07\xC0\x38\xFC\x98\x95\xBA\x3A\x97\xFD\x33\xE2\x59\xD2\x32\x5F\xBA\x02\x9E\x31\xB9\xC0";
    uint16_t len = 182;
    int32_t ret = 0;
    ret = lydia_tlv_read_data(tlv_msg, len,on_read_data);

    if (ret == 0) {
        DBG("[SUCCESS]\r\n");
    }else
    {
        DBG("[FAILED]\r\n");
    }
}

int main(void)
{
    test_tlv();
    return 0;
}